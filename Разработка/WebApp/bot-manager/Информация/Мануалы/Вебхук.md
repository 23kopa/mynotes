–ï—Å–ª–∏ –µ—â—ë –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Python –∏ Flask ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏:
```bash
sudo apt update
sudo apt install python3 python3-pip -y
pip3 install flask
```
***
```bash
nano deploy.sh
```

```bash
#!/bin/bash

# –í–∫–ª—é—á–∞–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ–≥–æ –≤—ã–≤–æ–¥–∞ –≤ —Ñ–∞–π–ª
exec > /var/log/deploy.log 2>&1
echo "===== DEPLOY START: $(date) ====="
echo "üë§ –°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: $(whoami)"

# –ü—É—Ç–∏
PROJECT_DIR="/var/www/botmanager"
SERVICE_NAME="botmanager"

# –ü–µ—Ä–µ—Ö–æ–¥ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
echo "üìÅ –ü–µ—Ä–µ—Ö–æ–¥ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é $PROJECT_DIR"
cd "$PROJECT_DIR" || { echo "‚ùå –û—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å –ø–µ—Ä–µ–π—Ç–∏ –≤ $PROJECT_DIR"; exit 1; }

# –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–∑ origin/main
echo "üì• –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –∏–∑ git..."
git fetch origin
git reset --hard origin/main

# –û—á–∏—Å—Ç–∫–∞ –Ω–µ–æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤, –∫—Ä–æ–º–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
echo "üßπ –û—á–∏—Å—Ç–∫–∞ untracked —Ñ–∞–π–ª–æ–≤ (venv, .env –∏ —Ç.–¥. —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è)"
git clean -fd -e venv -e .env -e .git -e .gitignore -e deploy.sh

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
echo "üîÅ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞ $SERVICE_NAME..."
if systemctl restart "$SERVICE_NAME"; then
    echo "‚úÖ –°–µ—Ä–≤–∏—Å $SERVICE_NAME —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω"
else
    echo "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–∏—Å–∞ $SERVICE_NAME"
    exit 1
fi

# –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ
echo "‚úÖ DEPLOY FINISHED: $(date)"
```

```bash
chmod +x /var/www/botmanager/deploy.sh
```

***
–°–æ–∑–¥–∞–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø–æ–¥ –≤–µ–±—Ö—É–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `/opt/webhook`), –ø–µ—Ä–µ–π–¥–∏ –≤ –Ω–µ—ë:
```bash
mkdir -p /opt/webhook
cd /opt/webhook
```

```bash
nano webhook_listener.py
```

```python
from flask import Flask, request
import subprocess
from datetime import datetime

app = Flask(__name__)

@app.route('/webhook', methods=['POST'])
def webhook():
    try:
        with open('/var/log/webhook_debug.log', 'a') as f:
            f.write(f'[{datetime.now()}] Webhook triggered\n')
        subprocess.Popen(['/bin/bash', '/var/www/botmanager/deploy.sh'])
        return 'OK', 200
    except Exception as e:
        with open('/var/log/webhook_debug.log', 'a') as f:
            f.write(f'[{datetime.now()}] Error: {e}\n')
        return 'Internal Server Error', 500

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5001)
```
***
–û—Ç–∫—Ä–æ–π –ø–æ—Ä—Ç 5001 –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
```bash
sudo ufw allow 5001/tcp
```
***
–°–æ–∑–¥–∞–π —Ñ–∞–π–ª —Å–µ—Ä–≤–∏—Å–∞:
```bash
sudo nano /etc/systemd/system/webhook.service
```
–í—Å—Ç–∞–≤—å –∫–æ–¥:
```ini
[Unit]
Description=GitHub Webhook Listener
After=network.target

[Service]
User=root
WorkingDirectory=/opt/webhook
ExecStart=/usr/bin/python3 /opt/webhook/webhook_listener.py
Restart=always

[Install]
WantedBy=multi-user.target

```

```bash
sudo systemctl daemon-reexec
sudo systemctl daemon-reload
sudo systemctl enable webhook.service
sudo systemctl start webhook.service
sudo systemctl status webhook.service
```
***

```
tail -f /var/log/webhook_debug.log
```
