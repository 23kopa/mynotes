## üìå –û–±—â–∞—è —Ç–µ–æ—Ä–∏—è

### –ß—Ç–æ —Ç–∞–∫–æ–µ Snort?

**Snort** ‚Äî —ç—Ç–æ **—Å–µ—Ç–µ–≤–æ–π –¥–∞—Ç—á–∏–∫ –≤—Ç–æ—Ä–∂–µ–Ω–∏–π (NIDS)** —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç—ã –∫–∞–∫:

- —Å–∏—Å—Ç–µ–º—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –≤—Ç–æ—Ä–∂–µ–Ω–∏–π (**IDS**),
    
- —Å–∏—Å—Ç–µ–º—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –≤—Ç–æ—Ä–∂–µ–Ω–∏–π (**IPS**),
    
- –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞ –ø–∞–∫–µ—Ç–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.
    

Snort —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –Ω–∞ C –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ Unix-—Å–∏—Å—Ç–µ–º –∏ Windows. –û–Ω –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Å–∏–≥–Ω–∞—Ç—É—Ä–Ω–æ–º –∞–Ω–∞–ª–∏–∑–µ, –Ω–æ —Ç–∞–∫–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞–Ω–∞–ª–∏–∑ –ø–æ –ø–æ–≤–µ–¥–µ–Ω–∏—é –∏ –∞–Ω–æ–º–∞–ª–∏—è–º.

---

## üß© –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã Snort

1. **Packet Decoder (–¥–µ–∫–æ–¥–µ—Ä –ø–∞–∫–µ—Ç–æ–≤)** ‚Äì –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å—ã—Ä—ã–µ –ø–∞–∫–µ—Ç—ã —Å —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.
    
2. **Preprocessors (–ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞)** ‚Äì –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç —Ç—Ä–∞—Ñ–∏–∫ –ø–µ—Ä–µ–¥ –∞–Ω–∞–ª–∏–∑–æ–º –ø—Ä–∞–≤–∏–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è, —Ä–∞–∑–±–æ—Ä –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤).
    
3. **Detection Engine (–¥–≤–∏–∂–æ–∫ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è)** ‚Äì –æ—Å–Ω–æ–≤–Ω–∞—è —á–∞—Å—Ç—å, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–∞–∫–µ—Ç—ã –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–∞–≤–∏–ª–∞–º.
    
4. **Logging and Alerting System** ‚Äì –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∑–∞–ø–∏—Å—å —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π –≤ –ª–æ–≥-—Ñ–∞–π–ª—ã –∏/–∏–ª–∏ –∫–æ–Ω—Å–æ–ª—å.
    
5. **Output Modules** ‚Äì –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç, –∫–∞–∫ –≤—ã–≤–æ–¥–∏—Ç—å –¥–∞–Ω–Ω—ã–µ: –≤ —Ñ–∞–π–ª, –±–∞–∑—É, –∫–æ–Ω—Å–æ–ª—å, syslog –∏ —Ç.–ø.
    

---

## üåê –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã

Snort –º–æ–∂–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞—Ñ–∏–∫ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤—Å–µ—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤:

- **Ethernet** ‚Äì —É—Ä–æ–≤–µ–Ω—å –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö (L2),
    
- **IP (IPv4/IPv6)** ‚Äì —Å–µ—Ç–µ–≤–æ–π —É—Ä–æ–≤–µ–Ω—å (L3),
    
- **ICMP, TCP, UDP** ‚Äì —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å (L4),
    
- **HTTP, FTP, DNS, SSH, SMB, SMTP, SIP, SNMP** –∏ –¥—Ä. ‚Äì –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–π —É—Ä–æ–≤–µ–Ω—å (L7).
    

---

## üñß –ö–∞–∫ Snort —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∂–µ–ª–µ–∑–æ–º?

- **–°–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ —Ä–µ–∂–∏–º–µ –ø—Ä–æ–º–∏—Å–∫—É–∏—Ç–µ—Ç–∞**: Snort —Å–ª—É—à–∞–µ—Ç –≤–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫, –ø—Ä–æ—Ö–æ–¥—è—â–∏–π —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–Ω–µ —Ç–æ–ª—å–∫–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∫ —ç—Ç–æ–π –º–∞—à–∏–Ω–µ).
    
- –ú–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞ —Å–µ—Ç–µ–≤–∞—è –∫–∞—Ä—Ç–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏–ª–∏ offloading.
    
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –≤—ã—Å–æ–∫–æ–π –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π –º–æ—â–Ω–æ—Å—Ç–∏ –Ω–∞ –Ω–µ–±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–∞—Ö, –Ω–æ –Ω–∞ –±–æ–ª—å—à–∏—Ö —Å–µ—Ç—è—Ö –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–Ω–æ–≥–æ—è–¥–µ—Ä–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –∏ –≤—ã—Å–æ–∫–æ—Å–∫–æ—Ä–æ—Å—Ç–Ω—É—é –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—É—é –ø–∞–º—è—Ç—å.
    

---

## üì• –í–∏–¥—ã –∞—Ç–∞–∫ –∏ –∫–∞–∫ Snort –∏—Ö —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç

- **Port scan**: —á–µ—Ä–µ–∑ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã –Ω–∞ SYN-–ø–∞–∫–µ—Ç—ã –∏–ª–∏ –Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π.
    
- **Ping flood, ICMP-–∞—Ç–∞–∫–∏**: —á–µ—Ä–µ–∑ TTL –∏ ICMP-—Ç–∏–ø—ã.
    
- **SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏, XSS, –∫–æ–º–∞–Ω–¥–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏**: —á–µ—Ä–µ–∑ `content` –∏ `pcre`.
    
- **DDoS, SYN Flood**: —á–µ—Ä–µ–∑ `threshold`, `dsize`, `flags:S`.
    
- **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ç—Ä–æ—è–Ω–æ–≤, RAT, —Å–∫–∞–º–∞** ‚Äì —á–µ—Ä–µ–∑ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã –ø–æ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–º —Å—Ç—Ä–æ–∫–∞–º, –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º –±–∞–π—Ç.
***
## üõ°Ô∏è IDS vs IPS

| IDS (–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ)              | IPS (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ)           |
| ------------------------------ | ------------------------------ |
| –¢–æ–ª—å–∫–æ —É–≤–µ–¥–æ–º–ª—è–µ—Ç              | –ú–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∞—Ç–∞–∫–∏        |
| –ë–µ–∑–æ–ø–∞—Å–µ–Ω, –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ç—Ä–∞—Ñ–∏–∫ | –ú–æ–∂–µ—Ç –≤–º–µ—à–∏–≤–∞—Ç—å—Å—è –≤ –ø–æ—Ç–æ–∫      |
| –û–±—ã—á–Ω–æ –≤ –ø–∞—Å—Å–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ      | –ß–∞—Å—Ç–æ –≤ –∞–∫—Ç–∏–≤–Ω–æ–º inline-—Ä–µ–∂–∏–º–µ |
***
## üìö Flowbits, Threshold, Preprocessors

- **Flowbits**: –º–µ—Ö–∞–Ω–∏–∑–º –∑–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π —Ç—Ä–∞—Ñ–∏–∫–∞. –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ —Å–µ—Å—Å–∏–π (`set`, `isset`, `toggle`).
    
- **Threshold**: –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π (–≤–∞–∂–Ω–æ –¥–ª—è DDoS).
    
- **Preprocessors**: –º–æ–¥—É–ª–∏ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å —Å–∏–≥–Ω–∞—Ç—É—Ä–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, normalize, frag3, stream5).
***
- –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å—Ä–µ–¥—ã
    
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Snort
    
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª
    
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª
    
- –ê–Ω–∞–ª–∏–∑ –∞—Ç–∞–∫—É—é—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
    
- –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏
    
- –û—Ç–≤–µ—Ç—ã –Ω–∞ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã
    
- –í—ã–≤–æ–¥ –ø–æ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç–µ